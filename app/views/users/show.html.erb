<% if current_user %>
  <!-- Display Description, Final Rating and Review to companion in show page -->
    <% if current_user.identification === "Companion" %>
      Description:<%= @user.description %><br>
      Average Rating:
      <% if final_rating(@user) >= 0 %>
        <%= final_rating(@user) %><br>
      <% else %>
        <p class="notification">No rating yet</p>
      <% end %>
      Reviews:<br>
      <% current_user.reviews.each do |review| %>
        <%= review.comment %><br>
        Stars: <%= individaul_rating(review) %><br>
        by:<%= review.reviewer.email %><br>
      <% end %>
    <% end %>
  <!-- Display Companions and All the review generated by Companion to signed in User and Seniors to make Request -->
  <% if @user.availability === true && current_user.id != @user.id %>
    Description:<%= @user.description %><br>
    <% if final_rating(@user) >= 0 %>
      <%= final_rating(@user) %><br>
    <% else %>
      <p class="notification">No rating yet</p>
    <% end %>
    Reviews:<br>
    <% @user.reviews.each do |review| %>
      <%= review.comment %><br>
      Stars: <%= individaul_rating(review) %><br>
      by:<%= review.reviewer.email %><br>
    <% end %>
    Available to work<br>
    <% if aval(@user,current_user) %>
      <% aval(@user,current_user).each do |date| %>
        <%= date %><br>
      <% end %>
    <% end %>
    <%= link_to "Make a Request", new_user_appointment_path(@user) %>
  <% end %>
  <!-- Display all the Appointments to either senior or companion and they can rate each other -->
  <% if current_user.id === @user.id %>
    <!-- Senior Display part -->
    <% if current_user.seniors.length >= 1 %>
      Average Rating <%= final_rating(@user) %><br>
      Reviews:<br>
      <% current_user.reviews.each do |review| %>
        <%= review.comment %><br>
        Stars: <%= individaul_rating(review) %><br>
        by:<%= review.reviewer.email %><br>
      <% end %>
      <p class="notification">This are all your companions</p>
      <% current_user.seniors.each do |senior|%>
        <!-- Seniors waiting on responds from companion -->
        <% if senior.accept === false %>
          You are waiting on a request from <%= senior.companion.first_name %>
        <% end %>
        <%= senior.companion.email %><br>
        <% if Date.today - 2 > senior.end_date %>
          <%= link_to 'Rate companionship', new_user_review_path(senior.companion.id) %><br>
        <% end %>
      <% end %>
    <!-- Companion Display part -->
    <% elsif current_user.companions.length >= 1%>
        <!-- Display Recent appointment notification -->
      <!--   <%# if current_user.companions.last.accept === false %>
            <p class="notification">You have a new request</p>
            <%#= link_to "Accept this request", edit_appointment_path(current_user.companions.last)%>
        <%# end %> -->
        <p class="notification">This are all your seniors</p>
        <% current_user.companions.each do |companion| %>
          <% if companion.accept === true %>
            <%= companion.senior.email  %><br>
            <% if Date.today - 2 > companion.end_date %>
               <%= link_to 'Rate companionship', new_user_review_path(companion.senior.id) %><br>
            <% end %>
          <% elsif companion.accept === false %>
            <%= link_to "Accept this request", edit_appointment_path(companion)%><br>
          <% end %>
        <% end %>
    <% end %>
  <% end %>
<% end %>

